<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>{% block title %}PCMart{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
  <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}">

  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f8f9fa;
      margin: 0;
    }

    .sidebar {
      position: fixed;
      top: 0;
      left: 0;
      width: 240px;
      min-height: 100vh;
      border-right: none !important;
      z-index: 1030;
    }
    .sidebar .nav-link {
      color: #dbeafe;
      border-radius: 0.7rem;
      padding: 0.55rem 1rem;
      font-size: 1rem;
      transition: background 0.12s, color 0.12s;
    }
    .sidebar .nav-link.active,
    .sidebar .nav-link:hover {
      background: #ffffff22;
      color: #fff;
      font-weight: 600;
    }
    .sidebar .nav-link i {
      font-size: 1.25em;
    }

    .navbar {
      position: fixed;
      top: 0;
      left: 240px;   /* Match the sidebar width */
      right: 0;
      height: 60px;
      background-color: #ffffff;
      border-bottom: 1px solid #dee2e6;
      display: flex;
      align-items: center;
      padding: 0 1rem;
      z-index: 1000;
    }

    .main-content {
      margin-left: 240px;
      margin-top: 0;
      padding: 0 0.9rem 1.1rem 1.2rem;
      min-height: 100vh;
      background: #f8f9fa;
    }
    @media (max-width: 991px) {
      .sidebar {
        display: none !important;
      }
      .main-content {
        margin-left: 0;
        padding: 10px 0.5rem 0.7rem 0.5rem;
      }
      .navbar {
        left: 0 !important;
      }
    }

    .navbar-brand {
      font-weight: bold;
      font-size: 1.2rem;
    }

    .alert {
      margin-top: 1rem;
    }

    .btn {
      border-radius: 30px;
    }
  </style>
</head>
<body>

<div class="sidebar d-flex flex-column justify-content-between py-3 px-2" style="background: linear-gradient(180deg, #0057b7 0%, #0c2546 100%); border-radius: 1.4rem 0 0 1.4rem; box-shadow: 2px 0 16px #0057b726;">
  <div>
    <div class="text-center mb-4">
      <a href="{{ url_for('dashboard_bp.main_dashboard') }}" style="text-decoration: none;">
        <!-- <img src="{{ url_for('static', filename='pcmart-logo.png') }}" alt="PCMart" width="48" height="48" style="border-radius: 12px; background:#fff; box-shadow:0 2px 8px #2221;"> -->
        <h2 class="fw-bold mt-2 mb-0 text-white" style="font-size: 1.17rem; letter-spacing: 0.01em;">PCMart</h2>
      </a>
    </div>
    <nav class="nav flex-column">
      {% if current_user.is_authenticated and current_user.role == 'technician' %}
        <a href="{{ url_for('stock_bp.process_stage_update') }}" class="nav-link my-1">
          <i class="bi bi-tools me-2"></i>Processing
        </a>
      {% else %}
        <a href="{{ url_for('dashboard_bp.main_dashboard') }}" class="nav-link my-1 {% if request.endpoint == 'dashboard_bp.main_dashboard' %}active{% endif %}">
          <i class="bi bi-house-door me-2"></i>Home
        </a>
        <a href="{{ url_for('stock_bp.stock_intake') }}" class="nav-link my-1">
          <i class="bi bi-box-seam me-2"></i>Stock Intake
        </a>
        <a href="{{ url_for('stock_bp.process_stage_update') }}" class="nav-link my-1">
          <i class="bi bi-tools me-2"></i>Processing
        </a>
        <a href="{{ url_for('sales_bp.create_sale_form') }}" class="nav-link my-1">
          <i class="bi bi-cash-coin me-2"></i>Create Sale
        </a>
        <a href="{{ url_for('order_bp.reserve_product') }}" class="nav-link my-1">
          <i class="bi bi-pin-angle me-2"></i>Reserve
        </a>
        <a href="{{ url_for('order_bp.customer_orders') }}" class="nav-link my-1">
          <i class="bi bi-card-list me-2"></i>Customer Orders
        </a>
        <a href="{{ url_for('customers_bp.customer_center') }}" class="nav-link my-1">
          <i class="bi bi-person me-2"></i>Customers
        </a>
        <a href="{{ url_for('vendors_bp.vendor_center') }}" class="nav-link my-1">
          <i class="bi bi-shop-window me-2"></i>Vendors
        </a>
        <a href="{{ url_for('parts_bp.parts_list') }}" class="nav-link my-1">
          <i class="bi bi-tools me-2"></i>Parts
        </a>
        {% if current_user.is_authenticated and current_user.role == 'admin' %}
          <a href="{{ url_for('auth_bp.register_user') }}" class="nav-link my-1">
            <i class="bi bi-person-plus me-2"></i>Register User
          </a>
        {% endif %}
        {% if current_user.is_authenticated and current_user.role in ['admin', 'supervisor'] %}
          <a href="{{ url_for('reports_bp.tech_productivity') }}" class="nav-link my-1">
            <i class="bi bi-bar-chart-steps me-2"></i>Tech Productivity
          </a>
        {% endif %}
      {% endif %}
    </nav>
  </div>
  <div class="mb-2 text-center">
    <a href="{{ url_for('auth_bp.logout') }}" class="btn btn-outline-danger btn-sm rounded-pill w-75 mt-3">
      <i class="bi bi-box-arrow-left me-1"></i>Logout
    </a>
  </div>
</div>

<div class="offcanvas offcanvas-start d-lg-none" tabindex="-1" id="offcanvasSidebar" aria-labelledby="offcanvasSidebarLabel" style="background: linear-gradient(180deg, #0057b7 0%, #0c2546 100%);">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title text-white" id="offcanvasSidebarLabel">PCMart</h5>
    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <div class="offcanvas-body d-flex flex-column justify-content-between p-0">
    <nav class="nav flex-column px-3">
      {% if current_user.is_authenticated and current_user.role == 'technician' %}
        <a href="{{ url_for('stock_bp.process_stage_update') }}" class="nav-link my-1 text-white">
          <i class="bi bi-tools me-2"></i>Processing
        </a>
      {% else %}
        <a href="{{ url_for('dashboard_bp.main_dashboard') }}" class="nav-link my-1 {% if request.endpoint == 'dashboard_bp.main_dashboard' %}active{% endif %} text-white">
          <i class="bi bi-house-door me-2"></i>Home
        </a>
        <a href="{{ url_for('stock_bp.stock_intake') }}" class="nav-link my-1 text-white">
          <i class="bi bi-box-seam me-2"></i>Stock Intake
        </a>
        <a href="{{ url_for('stock_bp.process_stage_update') }}" class="nav-link my-1 text-white">
          <i class="bi bi-tools me-2"></i>Processing
        </a>
        <a href="{{ url_for('sales_bp.create_sale_form') }}" class="nav-link my-1 text-white">
          <i class="bi bi-cash-coin me-2"></i>Create Sale
        </a>
        <a href="{{ url_for('order_bp.reserve_product') }}" class="nav-link my-1 text-white">
          <i class="bi bi-pin-angle me-2"></i>Reserve
        </a>
        <a href="{{ url_for('order_bp.customer_orders') }}" class="nav-link my-1 text-white">
          <i class="bi bi-card-list me-2"></i>Customer Orders
        </a>
        <a href="{{ url_for('customers_bp.customer_center') }}" class="nav-link my-1 text-white">
          <i class="bi bi-person me-2"></i>Customers
        </a>
        <a href="{{ url_for('vendors_bp.vendor_center') }}" class="nav-link my-1 text-white">
          <i class="bi bi-shop-window me-2"></i>Vendors
        </a>
        <a href="{{ url_for('parts_bp.parts_list') }}" class="nav-link my-1 text-white">
          <i class="bi bi-tools me-2"></i>Parts
        </a>
        {% if current_user.is_authenticated and current_user.role == 'admin' %}
          <a href="{{ url_for('auth_bp.register_user') }}" class="nav-link my-1 text-white">
            <i class="bi bi-person-plus me-2"></i>Register User
          </a>
        {% endif %}
        {% if current_user.is_authenticated and current_user.role in ['admin', 'supervisor'] %}
          <a href="{{ url_for('reports_bp.tech_productivity') }}" class="nav-link my-1 text-white">
            <i class="bi bi-bar-chart-steps me-2"></i>Tech Productivity
          </a>
        {% endif %}
      {% endif %}
    </nav>
    <div class="mb-2 text-center px-3">
      <a href="{{ url_for('auth_bp.logout') }}" class="btn btn-outline-danger btn-sm rounded-pill w-100 mt-3">
        <i class="bi bi-box-arrow-left me-1"></i>Logout
      </a>
    </div>
  </div>
</div>


<div class="navbar">
  <button class="btn btn-outline-primary d-lg-none me-2" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSidebar" aria-controls="offcanvasSidebar" aria-label="Open menu">
    <i class="bi bi-list" style="font-size:1.6rem;"></i>
  </button>
  <span class="navbar-brand mb-0 h1">
    {% block titlebar %}Dashboard{% endblock %}
  </span>
</div>

<div class="container" style="max-width: 900px; margin-top: 70px;">
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert" style="z-index:2000;">
          {{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      {% endfor %}
    {% endif %}
  {% endwith %}
</div>

<div class="main-content">
  {% block content %}{% endblock %}
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
